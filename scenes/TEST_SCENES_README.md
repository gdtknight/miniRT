# miniRT 종합 테스트 장면 파일 가이드

**작성일**: 2025-12-15  
**목적**: 모든 객체 타입과 중첩 렌더링 검증

---

## �� 새로 생성된 테스트 장면

### 1. test_comprehensive.rt - 종합 테스트
**설명**: 모든 객체 타입을 포함하고 일부 객체가 중첩되어 보이는 장면

**포함 요소**:
- ✅ 하얀색 평면 (바닥, y=-5)
- ✅ 구 3개 (빨강, 초록, 파랑) - 다양한 크기와 위치
- ✅ 평면 1개 (뒷벽, 회색-파랑 톤)
- ✅ 원기둥 3개 (다양한 방향과 색상)

**카메라 설정**:
- 위치: (0, 15, -40)
- 방향: 약간 아래를 향함 (0, -0.3, 1)
- FOV: 70도

**렌더링 특징**:
- 🎯 중첩된 객체들 (깊이 테스트)
- 🎯 다양한 색상 (빨강, 초록, 파랑, 노랑, 보라, 청록)
- 🎯 다양한 방향의 원기둥
- 🎯 그림자 효과

**실행**:
```bash
./miniRT scenes/test_comprehensive.rt
```

---

### 2. test_overlapping.rt - 중첩 객체 테스트
**설명**: 카메라 관점에서 객체들이 서로 겹쳐 보이는 복잡한 장면

**포함 요소**:
- ✅ 하얀색 평면 (바닥, y=-3)
- ✅ 구 5개 (앞쪽 3개 + 뒤쪽 2개) - 겹침 효과
- ✅ 원기둥 5개 (수직 3개 + 대각선 2개)
- ✅ 평면 4개 (좌우 벽 + 뒷벽)

**카메라 설정**:
- 위치: (5, 12, -35)
- 방향: 대각선 아래 (약간 왼쪽) (-0.15, -0.3, 1)
- FOV: 75도

**렌더링 특징**:
- 🎯 **객체 중첩** (가까운 객체가 먼 객체를 가림)
- 🎯 **깊이감** (z축 5~40 범위)
- 🎯 **다양한 원기둥 방향**
- 🎯 **벽으로 둘러싸인 공간감**

**실행**:
```bash
./miniRT scenes/test_overlapping.rt
```

---

### 3. test_all_objects.rt - 모든 객체 총집합
**설명**: 최대한 많은 객체를 포함한 스트레스 테스트 장면

**포함 요소**:
- ✅ 하얀색 평면 (바닥, y=-5)
- ✅ **구 7개** (무지개 색상: 빨강→보라)
- ✅ **원기둥 7개** (수직 4개 + 수평/대각선 3개)
- ✅ **평면 4개** (바닥 + 좌우 벽 + 뒷벽)

**카메라 설정**:
- 위치: (10, 20, -50)
- 방향: 대각선 아래 (-0.2, -0.35, 1)
- FOV: 80도 (넓은 시야각)

**렌더링 특징**:
- 🎯 **18개 객체** (최대 복잡도)
- 🎯 **무지개 색상** (빨주노초파남보)
- 🎯 **넓은 FOV** (많은 객체 한 번에)
- 🎯 **성능 테스트** (렌더링 시간 측정)

**실행**:
```bash
./miniRT scenes/test_all_objects.rt
```

---

## 📊 장면 비교표

| 장면 | 구 | 평면 | 원기둥 | 총 객체 | 특징 |
|------|-----|------|--------|---------|------|
| test_comprehensive | 3 | 2 | 3 | 8 | 기본 중첩 |
| test_overlapping | 5 | 5 | 5 | 15 | 복잡한 중첩 |
| test_all_objects | 7 | 4 | 7 | 18 | 최대 객체 수 |

---

## 🎯 테스트 목적별 추천

### 기본 기능 확인
```bash
./miniRT scenes/test_comprehensive.rt
```
- 모든 객체 타입 렌더링
- 기본적인 중첩 효과
- 적당한 복잡도

### 깊이 버퍼 테스트
```bash
./miniRT scenes/test_overlapping.rt
```
- 객체 간 가림 효과
- 정확한 깊이 정렬
- 벽으로 둘러싸인 공간

### 성능 테스트
```bash
./miniRT scenes/test_all_objects.rt
```
- 최대 객체 수
- 렌더링 시간 측정
- 메모리 사용량 확인

---

## 🔍 각 장면의 세부 설정

### test_comprehensive.rt

**조명 설정**:
- 주변광: 20% (밝은 편)
- 조명 위치: (-20, 30, -20) 왼쪽 위
- 조명 밝기: 80%

**객체 배치** (카메라 기준):
```
             뒷벽 (평면)
                |
    cy1    sp3  cy3  sp2
       cy2   sp1
    -------------------- (바닥 평면)
        
         👁️ 카메라
```

**색상 배치**:
- 구: 빨강(좌), 초록(우), 파랑(중앙 뒤)
- 원기둥: 노랑(좌), 보라(우), 청록(중앙 뒤)

---

### test_overlapping.rt

**조명 설정**:
- 주변광: 25% (약간 밝음)
- 조명 위치: (-15, 25, -15) 왼쪽 위
- 조명 밝기: 90%

**객체 배치** (깊이별):
```
Z=8~12:  sp1, sp2, sp3 (앞줄 구)
Z=14~15: sp4, sp5 (중간줄 구, 겹침!)
Z=18~25: cy들 (원기둥, 다양한 방향)
Z=40:    뒷벽 (평면)
```

**중첩 효과**:
- sp4와 sp5가 뒤의 원기둥과 겹침
- cy들이 서로 교차하는 위치
- 좌우 벽이 가장자리 객체 가림

---

### test_all_objects.rt

**조명 설정**:
- 주변광: 30% (밝은 환경)
- 조명 위치: (-25, 40, -25) 높은 곳
- 조명 밝기: 100% (최대)

**객체 배치** (무지개 순서):
```
Z=5~20:   빨주노초 구 (앞줄)
Z=25~35:  파남보 구 (뒷줄)
Z=15~45:  원기둥 (깊이별 분포)
```

**색상 코드**:
- 빨강: (255, 0, 0)
- 주황: (255, 127, 0)
- 노랑: (255, 255, 0)
- 초록: (0, 255, 0)
- 파랑: (0, 0, 255)
- 남색: (127, 0, 255)
- 보라: (255, 0, 255)

---

## 💡 렌더링 팁

### 예상 렌더링 시간
- **test_comprehensive**: ~10-15초 (8개 객체)
- **test_overlapping**: ~20-30초 (15개 객체)
- **test_all_objects**: ~30-50초 (18개 객체)

### 최적화 시 고려사항
1. 가까운 객체부터 검사 (조기 종료)
2. 광선-바운딩 박스 사전 검사
3. 공간 분할 (옥트리, BVH)

### 메모리 사용량
- 장면 데이터: ~1-2KB
- 이미지 버퍼: ~1.4MB (800x600x3)
- 총 예상: ~2-3MB

---

## 🐛 디버깅 가이드

### 객체가 안 보이는 경우
1. **카메라 방향 확인**
   - 방향 벡터가 객체를 향하는지
   - FOV가 충분한지

2. **객체 위치 확인**
   - Z 좌표가 카메라 앞인지 (양수)
   - 카메라 시야각 내에 있는지

3. **조명 확인**
   - 주변광이 0이 아닌지
   - 객체가 완전히 그림자에 가려지지 않았는지

### 중첩이 이상한 경우
1. **깊이 비교 확인**
   - hit.distance가 올바르게 업데이트되는지
   - 가장 가까운 교차점을 선택하는지

2. **교차점 계산 확인**
   - t > 0.001 검사 (자기 자신과의 교차 방지)
   - t < hit->distance 검사 (더 가까운 객체 우선)

---

## ✅ 검증 체크리스트

### test_comprehensive.rt
- [ ] 3개의 구가 모두 보임
- [ ] 2개의 평면 (바닥, 뒷벽) 보임
- [ ] 3개의 원기둥이 다른 방향으로 보임
- [ ] 조명과 그림자 효과 확인
- [ ] 색상이 정확함 (빨강, 초록, 파랑 등)

### test_overlapping.rt
- [ ] 앞의 구가 뒤의 구를 가림
- [ ] 원기둥이 서로 교차
- [ ] 좌우 벽이 보임
- [ ] 뒷벽이 가장 뒤에 보임
- [ ] 깊이감이 느껴짐

### test_all_objects.rt
- [ ] 7개의 구가 무지개 색상으로 보임
- [ ] 7개의 원기둥이 다양한 방향
- [ ] 바닥 평면이 하얀색
- [ ] 3개의 벽이 다른 색상
- [ ] 렌더링이 1분 내 완료
- [ ] 메모리 누수 없음

---

## 📈 성능 벤치마크

### 측정 방법
```bash
# 시간 측정
time ./miniRT scenes/test_all_objects.rt

# 메모리 측정
valgrind --tool=massif ./miniRT scenes/test_comprehensive.rt
```

### 예상 성능 (800x600)
```
test_comprehensive:  480,000 픽셀 × 8 객체  = ~3.8M 교차 검사
test_overlapping:    480,000 픽셀 × 15 객체 = ~7.2M 교차 검사
test_all_objects:    480,000 픽셀 × 18 객체 = ~8.6M 교차 검사
```

---

## 🎨 시각적 예상 결과

### test_comprehensive.rt
```
       [뒷벽 - 회색파랑]
    
  [노랑 원기둥]  [파랑 구]  [보라 원기둥]
    [빨강 구]              [초록 구]
       [청록 원기둥]
    
========================== [하얀 바닥]
```

### test_overlapping.rt
```
       [뒷벽 - 회색파랑]
  
[벽]  [여러 구들 겹침]  [여러 원기둥 교차]  [벽]
         [앞↔뒤 깊이감]
    
========================== [하얀 바닥]
```

### test_all_objects.rt
```
          [뒷벽 - 초록톤]
  
[벽] [빨주노초] [원기둥들] [파남보] [벽]
      [무지개]    [다방향]   [무지개]
    
========================== [하얀 바닥]
```

---

**작성자**: GitHub Copilot CLI  
**작성일**: 2025-12-15  
**장면 개수**: 3개 (종합, 중첩, 전체)  
**총 객체**: 최대 18개
